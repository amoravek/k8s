<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Kubernetes I.</title>
    <!-- Styles -->
    
    <link rel="stylesheet" href="file:///usr/lib/python3/dist-packages/darkslide/themes/default/css/base.css">
    <link rel="stylesheet" media="print" href="file:///usr/lib/python3/dist-packages/darkslide/themes/default/css/print.css">
    <link rel="stylesheet" media="screen, projection" href="file:///usr/lib/python3/dist-packages/darkslide/themes/default/css/screen.css">
    <link rel="stylesheet" media="all" href="file:///usr/lib/python3/dist-packages/darkslide/themes/default/css/theme.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="file:///usr/lib/python3/dist-packages/darkslide/themes/default/js/slides.js"></script>
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-1">
          <div class="inner">
            
            <header><h1>Kubernetes I.</h1></header>
            
            
            <section><p>Online poznámky: <a href="https://codimd.trask.cz/s/rJPCa8C0v">https://codimd.trask.cz/s/rJPCa8C0v</a></p>
<p>Použitý cluster: <a href="https://arm.lab.trask.cz/">https://arm.lab.trask.cz/</a></p>
<p>Adam Morávek, amoravek@trask.cz, +420 724 514 916</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              1/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-2">
          <div class="inner">
            
            <header><h1>Potřeba orchestrace kontejnerů</h1></header>
            
            
            <section>
<ul>
<li>organizovat několik málo kontejnerů s jednoduchou aplikací ješte celkem jde</li>
<li>ale co dělat v momentě, kdy existuje celý ekosystém kontejnerů se specifickými potřebami na:<ul>
<li>dostupnost</li>
<li>propustnost</li>
<li>bezpečnost</li>
<li>spravovatelnost</li>
<li>škálování</li>
<li>a mnohé další?</li>
</ul>
</li>
<li>je nevyhnutelné, aby existoval nástroj, který jednotnou cestou řeší tyto a mnohé další potřeby</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [5 min]
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              2/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-3">
          <div class="inner">
            
            <header><h1>Kubernetes</h1></header>
            
            
            <section>
<ul>
<li>zavádí <strong>deklarativní</strong> přístup ke správě kontejnerizovaných aplikací</li>
<li>v současné době jediná platforma, která dává dlouhodobý smysl jako cílová platforma pro kontejnerizované aplikace (můj osobní názor)</li>
<li>snadno rozšiřitelný a modulární</li>
<li>přenositelný téměř na jakýkoliv HW (viz https://arm.lab.trask.cz)</li>
<li>velmi dobře navržený</li>
<li>velmi dobře testovaný</li>
<li>velmi dobře <strong><em>zdokumentovaný</em></strong></li>
<li>bohužel ale...<strong>velmi složitý</strong></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [5 min]
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              3/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-4">
          <div class="inner">
            
            <header><h1>Příklad deklarativního způsobu konfigurace (YAML)</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
              <p>entry-backend</p>
            
            </section>
          </div>
          <footer>
            
              [5 min]
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              4/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-5">
          <div class="inner">
            
            <header><h1>Architektura Kubernetes (1)</h1></header>
            
            
            <section>
<p><img alt="file:///home/amoravek/projects/trask/k8s-skoleni/git/k8s/presentation/k8s-1/k8s-arch.png" src="file:///home/amoravek/projects/trask/k8s-skoleni/git/k8s/presentation/k8s-1/k8s-arch.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [10 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              5/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-6">
          <div class="inner">
            
            <header><h1>Architektura Kubernetes (2)</h1></header>
            
            
            <section><ul>
<li>API server: centrální vstupní bod clusteru, REST API</li>
<li>Scheduler: plánuje workload na konkrétní nody a hlídá jejich systémové zdroje (CPU, RAM, disk, ...)</li>
<li>Controller-manager: <em>hlídá</em> stav (controllerů) clusteru (deklarovaný stav vs reálný stav)</li>
<li>etcd: <em>uchovává</em> stav clusteru</li>
<li>Kubelet: "node agent" - hlídá pody, jejich kontejnery, stav node</li>
<li>Kube-proxy: na každém node směruje příchozí provoz </li>
<li>Container runtime (zde Docker): runtime pro běh kontejnerů - viz dále CNI</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [10 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              6/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-7">
          <div class="inner">
            
            <header><h1>Pod a jeho kontejnery</h1></header>
            
            
            <section>
<ul>
<li>základní abstrakcí Kubernetes je <em>Pod</em></li>
<li>Pod je nejmenší "nasaditelný" objekt, takový clusterový "atom"</li>
<li>V Podu jsou seskupeny kontejnery (jeden nebo více)</li>
<li>Pod je vždy schedulerem plánován se všemi svými kontejnery (kolokace)</li>
<li>Kontejnery v Podu nejsou izolované, ale sdílí kontext (opět Linux namespaces a cgroups)</li>
<li>Kontextem rozumíme např. sdílené úlořiště (volumes) nebo sdílený síťový namespace (komunikace přes localhost, sdílený prostor pro porty)</li>
</ul>
<p>(Příklad: examples/k8s/k8s-shared-network-ns - při delete je tam znatelná prodleva - PID 1)</p>
<p><a href="https://kubernetes.io/docs/concepts/workloads/pods/">https://kubernetes.io/docs/concepts/workloads/pods/</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [10 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              7/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-8">
          <div class="inner">
            
            <header><h1>Namespaces</h1></header>
            
            
            <section>
<ul>
<li>Kubernetes namespace slouží k izolaci objektů a zdrojů</li>
<li>
<p>ale také k plošnému nastavení různých kvót, limitů a autorizací:</p>
<p><code>kubectl describe namespace amo</code></p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [5min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              8/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-9">
          <div class="inner">
            
            <header><h1>Kubectl</h1></header>
            
            
            <section>
<ul>
<li>CLI rozhraní pro komunikaci s clusterem (resp API-serverem)</li>
<li>vyžaduje přítomnost konfiguračniho souboru, tzv. <em>kubeconfig</em> (uložen typicky v $HOME/.kube/config) - viz váš osobní kubeconfig rozesílaný před kurzem</li>
<li>kubeconfig obsahuje sady clusterů a uživatelů propojených kontexty</li>
<li>Praktické ukázky</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [20 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              9/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-10">
          <div class="inner">
            
            <header><h1>Příklad spuštění aplikace v podu – kubectl run + průzkum</h1></header>
            
            
            <section>
<ul>
<li>
<p>nejjednodušší způsob nasazení aplikace do Kubernetes:</p>
<ul>
<li><code>kubectl run app1 --image=nginx</code></li>
<li><code>kubectl create deployment app1-deployment \
    --image=nginx --replicas=2</code></li>
<li>(o deploymentu později)</li>
</ul>
</li>
<li>
<p>totéž lze docílit i vytvořením yaml - yaml je ale těžko zapamatovatelný, takže google nebo uložené šablony?</p>
</li>
<li>
<p>lepší řešení ja kombinace - vytvořit jednoduchou kostru pomocí CLI a obohacovat (příklad). To má ale smysl jen na úrovni developmentu, všude jinde zařídí CI/CD.</p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [20 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              10/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-11">
          <div class="inner">
            
            <header><h1>K9s, Kubernetes Web IU (Dashboard)</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [10 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              11/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-12">
          <div class="inner">
            
            <header><h1>Deployment (1)</h1></header>
            
            
            <section>
<ul>
<li>vytvořínme-li pod, zajistíme si tím jen to, že nám naše aplikace tak nějak běží v Kubernetes</li>
<li>kde je ale přidaná hodnota?</li>
<li>pokud pod spadne (=proces s PID 1 v kontejneru zanikne), Kubernetes ho nastartuje automaticky znovu.</li>
<li>jak ale řešit následující potřeby?<ul>
<li>nasazení nové verze aplikace (image) bez výpadku</li>
<li>rollback nasazené verze</li>
<li>navýšení replik z důvodu rostoucí zátěže (nejlépe automaticky)</li>
<li>restart, znovunačtení konfigurace nebo změny stavu (yaml)?</li>
</ul>
</li>
<li>se samostatným Podem to lze, ale zbytečně složitě - proto existuje Deployment</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [5 min]
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              12/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-13">
          <div class="inner">
            
            <header><h1>Deployment (2)</h1></header>
            
            
            <section>
<p>Příklad - škálování:</p>
<pre><code>- `kubectl create deployment scaling --image=nginx \
    --replicas=1 --record`
- `kubectl scale deployment scaling --replicas=10 --record`
- `kubectl rollout status deployment`
- `kubectl scale deployment scaling --replicas=4 --record`
- `kubectl rollout status deployment`
</code></pre>
<ul>
<li>1 -&gt; 10 -&gt; 0 -&gt; 4 + průzkum + --replicas=10 - vysvětlit proč jen 6 replik</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [5 min]
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              13/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-14">
          <div class="inner">
            
            <header><h1>Deployment (3)</h1></header>
            
            
            <section><p>Rollout nové verze:</p>
<pre><code>- `kubectl create -f examples/k8s/k8s-shared-network-ns/deployment.yaml`
- `kubectl edit deployment interpod --record`
- `kubectl scale deployment interpod --replicas=2 --record`
- `kubectl scale deployment interpod --replicas=4 --record`
- `kubectl edit deployment interpod --record`
- `kubectl rollout history deployment interpod`
- `kubectl rollout history deployment interpod --revision X`
</code></pre>
<p>Vysvětlit, proč nejde rollback změn replik</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [5 min]
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              14/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-15">
          <div class="inner">
            
            <header><h1>Deployment (4)</h1></header>
            
            
            <section><p>Rollback</p>
<pre><code>- `kubectl rollout undo deployment interpod`
- `kubectl rollout undo deployment interpod --to-revision X`
</code></pre>
<p><a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">https://kubernetes.io/docs/concepts/workloads/controllers/deployment/</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [5 min]
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              15/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-16">
          <div class="inner">
            
            <header><h1>Přestávka</h1></header>
            
            
            <section>
<p><img alt="docker-vs-vm" src="file:///home/amoravek/projects/trask/k8s-skoleni/git/k8s/presentation/k8s-1/../common/coffee.jpg" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [15 min]
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              16/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code has_footer slide-17">
          <div class="inner">
            
            <header><h1>Perzistence (1)</h1></header>
            
            
            <section>
<ul>
<li>aby bylo možné uchovávat data produkovaná kontejnery v Podu, je potřeba je někam uložit (jinak zaniknou spolu s Podem)</li>
<li>
<p>na úrovni Podu (ukázat) je možné definovat externí úložiště - např.:</p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="nt">volumes</span><span class="p">:</span>
<span class="lineno">2 </span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test-volume</span>
<span class="lineno">3 </span>  <span class="nt">hostPath</span><span class="p">:</span>
<span class="lineno">4 </span>    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/data-xxx</span>
<span class="lineno">5 </span>    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DirectoryOrCreate</span>
</pre></div>

</li>
<li>
<p>aby bylo dostupné v <em>kontejneru</em>, je potřeba provést mount:</p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="lineno">2 </span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test-volume</span>
<span class="lineno">3 </span>  <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/data</span>
</pre></div>

</li>
<li>
<p>každý kontejner může provést mount téhož volume do jiného adresáře</p>
</li>
</ul>
<p><a href="https://kubernetes.io/docs/concepts/storage/volumes/">https://kubernetes.io/docs/concepts/storage/volumes/</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [20 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              17/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-18">
          <div class="inner">
            
            <header><h1>Perzistence (2)</h1></header>
            
            
            <section><ul>
<li>předchozí příklad sice funguje, ale takový přístup má řadu nedostatků:<ul>
<li>mixuje odpovědnost storage admina a vývojáře/devops inženýra</li>
<li>nelze nastavit oprávnění na úrovni Kubernetes</li>
<li>mnohdy je nutné zadat i přihlašovací údaje diktované volume pluginem</li>
<li>pokud je potřeba použít volume i z jiného Podu, je nutné duplikovat konfiguraci</li>
</ul>
</li>
</ul>
<p>Řešením je použíti PersistentVolume a PersistentVolumeClaim - příklady (examples/k8s/pv-pvc)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [20 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              18/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-19">
          <div class="inner">
            
            <header><h1>StorageClass</h1></header>
            
            
            <section><p>Jde to ale ještě snáze - pomocí StorageClass v kombinaci se storage autoprovisioningem
(a admin se do celého procesu vůbec nemusí montovat).</p>
<p>Příklad (examples/k8s/storageclass)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [20 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              19/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-20">
          <div class="inner">
            
            <header><h1>ConfigMap, Secret</h1></header>
            
            
            <section>
<ul>
<li>i když se mechanismy perzistence dají použít k přístupu ke konfiguračním souborům, není to dobrá praxe</li>
<li>existují totiž ConfigMap a Secret objekty - uchovávají<ul>
<li>textové i binární soubory</li>
<li>proměnné prostředí</li>
<li>citlivá data</li>
<li>PKI artefakty (certifikáty, klíče)</li>
</ul>
</li>
<li>je tu tedy další možnost separovat odpovědnost a vyjít vstříc CI/CD principům</li>
</ul>
<p>Příklad (examples/k8s/configmap-secret)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [15 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              20/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-21">
          <div class="inner">
            
            <header><h1>Services</h1></header>
            
            
            <section>
<ul>
<li>pody mají nestabilní IP i DNS name (=název Podu)</li>
<li>
<p>Objekt Service představuje elegantní způsob řešení:</p>
<ul>
<li><code>kubectl create deployment nginx --image=nginx</code></li>
<li><code>kubectl expose deployment nginx --port 8888 --target-port 80</code></li>
</ul>
</li>
<li>
<p>ClusterIP - pouze interně v rámci clusteru</p>
</li>
<li>NodePort - jednoduchý, funkční...ale ty porty...navíc obsadí porty na všech nodech</li>
<li>LoadBalancer - nejpohodlnější, ale v cloudu drahý (samostatná IP)</li>
</ul>
<p><a href="https://kubernetes.io/docs/concepts/services-networking/service/">https://kubernetes.io/docs/concepts/services-networking/service/</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [15 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              21/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-22">
          <div class="inner">
            
            <header><h1>Ingress a ingress controller</h1></header>
            
            
            <section>
<ul>
<li>objekt Ingress je pravidlo pro reverzní proxy deklarované v YAML</li>
<li>deklarujeme tedy pravidlo a o ostatní se postará reverzní proxy...a ta je kde?</li>
<li>je potřeba nainstalovat <em>ingress controller</em> (typicky kontejnerizovaný nginx nebo haproxy)</li>
<li>funguje jen pro HTTP</li>
<li>jako backend je použita Service typu ClusterIP</li>
</ul>
<p>Příklad (examples/k8s/ingress)</p>
<p>Závěr: <strong>pro HTTP je idealní vystavit ingress controller jako Service typu LoadBalancer a pro ostatní komunikaci použít buď LoadBalancer (drahé) nebo NodePort (levné, ale v Cloudu komplikované)</strong></p>
<p><a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">https://kubernetes.io/docs/concepts/services-networking/ingress/</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [20 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              22/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-23">
          <div class="inner">
            
            <header><h1>Přestávka na oběd</h1></header>
            
            
            <section>
<p><img alt="obed" src="file:///home/amoravek/projects/trask/k8s-skoleni/git/k8s/presentation/k8s-1/../common/open.knedliky.jpg" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [30 min - 1 h] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              23/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-24">
          <div class="inner">
            
            <header><h1>Controllery</h1></header>
            
            
            <section>
<ul>
<li>controllery udržují v Clusteru deklarovaný (požadovaný) stav (např. počet replik Podu)</li>
<li>každý controller řeší jinou úlohu</li>
<li>správu controllerů provádí komponenta Controller-manager</li>
<li>nejpoužívanější controller je Deployment</li>
</ul>
<p><a href="https://kubernetes.io/docs/concepts/architecture/controller/">https://kubernetes.io/docs/concepts/architecture/controller/</a></p>
<p>Příklady:</p>
<p><a href="https://kubernetes.io/docs/concepts/workloads/controllers/">https://kubernetes.io/docs/concepts/workloads/controllers/</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [10 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              24/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-25">
          <div class="inner">
            
            <header><h1>ReplicaSet, DaemonSet, StatefulSet, Job, CronJob</h1></header>
            
            
            <section>
<p>Příklady: examples/controllers</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [20 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              25/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-26">
          <div class="inner">
            
            <header><h1>Logování</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [10 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              26/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-27">
          <div class="inner">
            
            <header><h1>Liveness a readiness testy</h1></header>
            
            
            <section>
<ul>
<li>každý kontejner by měl mít deklarován způsob, jakým Kubelet pozná, že se správně inicializoval a zda funguje.</li>
<li>readiness probe = testuje, zda je kontejner připraven přijímat požadavky</li>
<li>liveness probe = periodicky testuje kontejner, zda je živý a zdravý</li>
<li>typy: <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#probe-v1-core">https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#probe-v1-core</a></li>
</ul>
<p><strong>Bez těchto testů nemůžeme mluvit o HA!</strong></p>
<p>Příklad: examples/k8s/readiness-liveness</p>
<p><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [15 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              27/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-28">
          <div class="inner">
            
            <header><h1>ImagePullPolicy</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [10 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              28/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_footer slide-29">
          <div class="inner">
            
            <header><h1>Resource requests &amp; limits</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [15 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              29/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-30">
          <div class="inner">
            
            <header><h1>Diskuse</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
              [15 min] 
            
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              30/30
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>

<!-- macro for generating subsection of TOC -->

<!-- end of macro -->

      <!-- generating sections of TOC -->
      
      <tr id="toc-row-1">
        <th><a href="#slide:1">Kubernetes I.</a></th>
        <td><a href="#slide:1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide:2">Potřeba orchestrace kontejnerů</a></th>
        <td><a href="#slide:2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide:3">Kubernetes</a></th>
        <td><a href="#slide:3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide:4">Příklad deklarativního způsobu konfigurace (YAML)</a></th>
        <td><a href="#slide:4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide:5">Architektura Kubernetes (1)</a></th>
        <td><a href="#slide:5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide:6">Architektura Kubernetes (2)</a></th>
        <td><a href="#slide:6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide:7">Pod a jeho kontejnery</a></th>
        <td><a href="#slide:7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide:8">Namespaces</a></th>
        <td><a href="#slide:8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide:9">Kubectl</a></th>
        <td><a href="#slide:9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide:10">Příklad spuštění aplikace v podu – kubectl run + průzkum</a></th>
        <td><a href="#slide:10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide:11">K9s, Kubernetes Web IU (Dashboard)</a></th>
        <td><a href="#slide:11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide:12">Deployment (1)</a></th>
        <td><a href="#slide:12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide:13">Deployment (2)</a></th>
        <td><a href="#slide:13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide:14">Deployment (3)</a></th>
        <td><a href="#slide:14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide:15">Deployment (4)</a></th>
        <td><a href="#slide:15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide:16">Přestávka</a></th>
        <td><a href="#slide:16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide:17">Perzistence (1)</a></th>
        <td><a href="#slide:17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide:18">Perzistence (2)</a></th>
        <td><a href="#slide:18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide:19">StorageClass</a></th>
        <td><a href="#slide:19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide:20">ConfigMap, Secret</a></th>
        <td><a href="#slide:20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide:21">Services</a></th>
        <td><a href="#slide:21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide:22">Ingress a ingress controller</a></th>
        <td><a href="#slide:22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide:23">Přestávka na oběd</a></th>
        <td><a href="#slide:23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide:24">Controllery</a></th>
        <td><a href="#slide:24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide:25">ReplicaSet, DaemonSet, StatefulSet, Job, CronJob</a></th>
        <td><a href="#slide:25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide:26">Logování</a></th>
        <td><a href="#slide:26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide:27">Liveness a readiness testy</a></th>
        <td><a href="#slide:27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide:28">ImagePullPolicy</a></th>
        <td><a href="#slide:28">28</a></td>
      </tr>
      
      
      <tr id="toc-row-29">
        <th><a href="#slide:29">Resource requests &amp; limits</a></th>
        <td><a href="#slide:29">29</a></td>
      </tr>
      
      
      <tr id="toc-row-30">
        <th><a href="#slide:30">Diskuse</a></th>
        <td><a href="#slide:30">30</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide next slide</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
    <br>
    <strong>Generated with Darkslide 5.1.0</strong>
  </div>
  <script>main()</script>
</body>
</html>